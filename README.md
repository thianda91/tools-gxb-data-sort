# 工信部网站高危客户数据整理小工具

通过台账统计工信部网站高危客户数据，统计用户号码进入工信部网站频次。

支持调整配置文件，以适配字段变更后的工信部导出文件。

支持读取带密码加密的 excel 文件。需要在配置文件中设置参数 `key`。批量读取多个文件时，密码需一致。

## 使用方法

1. 打开配置文件`config.ini`，修改各个参数。配置中井号 `#` 开头的是注释，用于解释参数含义。

> 若工信部导出文件内容有变，可能无法匹配历史台账的格式，此时需要手动修改台账格式来匹配新的工信部导出数据。

2. 运行小工具。运行方法：在地址栏输入 `cmd` ，在 cmd 中输入 `gxb_data_sort.exe` ，按回车运行。

> 可以敲出部分文件名后按 `TAB` 键补全，如输入前 2 个字母 `gx` 然后按 `TAB`补全。

3. 运行后会显示输出结果，若报错，请打包源文件及配置文件反馈至作者。

## 运行过程

1. 首先读取台账，若不存在则按配置文件创建一个空台账文件
2. 读取工信部导出数据，多个导出文件会全部读取并合并到一起
3. 若台账为空，将工信部导出数据当成台账，并做自我对比：基于“手机号”（配置文件中的`index`）去除重复项，并统计重复次数，更新“最近时间”（配置文件中的`last_time`）
4. 若台账不为空，则将台账与工信部导出数据做对比，补充台账，基于“手机号”（配置文件中的`index`）去除重复项，统计重复次数，更新“最近时间”（配置文件中的`last_time`）
5. 先备份台账，再将最新统计的台账写入到文件


## 文件列表

| 文件名            | 说明         |
| ----------------- | ------------ |
| gxb_data_sort.exe | 小程序主文件 |
| config.ini        | 配置文件     |
| README.pdf        | 使用说明     |


## 配置文件 `config.ini` 内容

```ini

[common]

##########----------读取工信部文件部分--------------------

# 读取工信部导出文件 文件包含的关键字
import_filename = 

# 读取工信部导出文件 的密码 设置为 0 表示没密码、设置为 1 表示自动识别密码，识别规则为文件名中4个数字表示的当日日期、设置为 任意字符，表示当前所有文件以此密码进行读取
key = 

# 读取工信部导出文件 的 sheet 名
read_sheet_name = 

# 接收时间列名（正确识别后将改名为下面的 first_time）
col_name_time = 接收时间

##########----------台账部分--------------------

# 台账路径
path = 客户数据.xlsx

# 台账索引列名
index = 

first_time = 首次接收时间
last_time = 最近时间
count = 次数
# 列名（用 tab 分割） 可从 excel 直接复制标题粘贴到这里。必须包含 4 个字段：`index` 、`first_time`、 `last_time`、 `count`
col_names = 

# 省份
province = 

# 写入台账的 sheet 名
book_sheet_name = 

# 备份方式 设置为 0 每次备份覆盖原备份文件，设置为 1 每次备份
backup_mode = 
```


## 更新历史

### v0.7(2022-10-24)

- 新增备份台账功能
- 完善配置文件内容
- 新增多项可调节配置、
- 新增配置文件自检测
- 优化报错提示

### v0.6(2022-09-30)

- 新增可读取加密 excel 的功能。

### v0.5(2022-09-27)

- 基本功能实现。